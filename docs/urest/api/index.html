<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>urest.api API documentation</title>
<meta name="description" content="Abstract base class and helper classes for the server-provided REST API …" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>urest.api</code></h1>
</header>
<section id="section-intro">
<p>Abstract base class and helper classes for the server-provided REST API</p>
<h2 id="overview">Overview</h2>
<p>During the marshalling of client requests (provided by the
<code><a title="urest.http.server.RESTServer" href="../http/server.html#urest.http.server.RESTServer">RESTServer</a></code> class), the path portion of the URI is extracted
from the client. This path is expected to take the form of</p>
<blockquote>
<p><code>/&lt; noun &gt;</code></p>
</blockquote>
<p>with the 'verb' denoted by the HTTP methods. Each 'noun' is implemented by a
class which inherits from <code><a title="urest.api.base.APIBase" href="base.html#urest.api.base.APIBase">APIBase</a></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All nouns are checked by<code><a title="urest.http.server.RESTServer" href="../http/server.html#urest.http.server.RESTServer">RESTServer</a></code>, and nouns will not be
properly routed unless <code><a title="urest.api.base.APIBase" href="base.html#urest.api.base.APIBase">APIBase</a></code> is an ancestor of the derived
class.</p>
</div>
<p>The 'noun' determines the resource of the request, and the 'verb' the action to
be taken on that resource. Also important is the intent of the client as
inferred from the underlying HTTP request, e.g. <code>GET</code> or <code>PUT</code>. Taken together
the URI and the client intent are mapped to methods of <code><a title="urest.api.base.APIBase" href="base.html#urest.api.base.APIBase">APIBase</a></code>
as follows</p>
<table>
<thead>
<tr>
<th>Verb</th>
<th>HTTP Method</th>
<th><code><a title="urest.api.base.APIBase" href="base.html#urest.api.base.APIBase">APIBase</a></code> method</th>
</tr>
</thead>
<tbody>
<tr>
<td>Get</td>
<td><code>GET</code></td>
<td><code><a title="urest.api.base.APIBase.get_state" href="base.html#urest.api.base.APIBase.get_state">APIBase.get_state()</a></code></td>
</tr>
<tr>
<td>Set</td>
<td><code>PUT</code></td>
<td><code><a title="urest.api.base.APIBase.set_state" href="base.html#urest.api.base.APIBase.set_state">APIBase.set_state()</a></code></td>
</tr>
<tr>
<td>Update</td>
<td><code>POST</code></td>
<td><code><a title="urest.api.base.APIBase.update_state" href="base.html#urest.api.base.APIBase.update_state">APIBase.update_state()</a></code></td>
</tr>
<tr>
<td>Delete</td>
<td><code>DELETE</code></td>
<td><code><a title="urest.api.base.APIBase.delete_state" href="base.html#urest.api.base.APIBase.delete_state">APIBase.delete_state()</a></code></td>
</tr>
</tbody>
</table>
<h2 id="example">Example</h2>
<h3 id="getting-the-noun-state">Getting the Noun State</h3>
<p>See <code><a title="urest.example.simpleled.SimpleLED" href="../example/simpleled.html#urest.example.simpleled.SimpleLED">SimpleLED</a></code> class a minimal implementation of a noun
controlling on GPIO pin, using the MicroPython <code>Pin</code> library. For the
<code><a title="urest.example.simpleled.SimpleLED" href="../example/simpleled.html#urest.example.simpleled.SimpleLED">SimpleLED</a></code> class, the exact pin being controlled is set
during the object instantiation, via the class constructor.</p>
<p>Assuming the <code><a title="urest.http.server.RESTServer" href="../http/server.html#urest.http.server.RESTServer">RESTServer</a></code> has been created as</p>
<p><code>python app = RESTServer()</code></p>
<p>then a 'noun' <code>led</code> can be registered via the
<code>urest.http.server.RESTServer.register_noun</code> method as</p>
<p><code>python app.register_noun('led', SimpleLED(28))</code></p>
<p>This will also bind the controlled GPIO pin to <code>Pin 28</code>: documentation for the
micro-controller and platform being used will be need to determine suitable
values.</p>
<p>Once the 'noun' has been registered, then the state of GPIO <code>Pin 28</code> can be
found by the HTTP request</p>
<pre><code>GET /led HTTP 1.1
</code></pre>
<h3 id="all-lookups-are-case-insensitive">All Lookup's Are Case Insensitive</h3>
<p>All nouns are registered with <code>urest.http.server.RESTServer</code> in <strong>lowercase</strong>.
Likewise all routing of API requests will also assume that the name of the noun
to be used will be in lowercase. Thus, for instance, calling</p>
<p><code>python app.register_noun('leD', SimpleLED(28))</code></p>
<p>or</p>
<p><code>python app.register_noun('LED', SimpleLED(28))</code></p>
<p>will <strong>all</strong> route to the name noun with the canonical name <code>led</code>. Likewise
the request</p>
<p><code>GET /lEd HTTP 1.1</code></p>
<p>or</p>
<p><code>GET /LED HTTP 1.1</code></p>
<p>will <strong>also</strong> route to the same noun with the canonical name <code>led</code>.</p>
<h3 id="setting-the-noun-state">Setting the Noun State</h3>
<p>Setting the state of the noun is a little more involved, as this will require
the desired state of the noun to be sent to the server. A useful tool for
testing purposes is the <a href="https://curl.se">curl</a> utility; available on most
platforms.</p>
<p>Continuing the minimal example above, the command line</p>
<pre><code>curl -X PUT -d '{&quot;led&quot;:&quot;0&quot;}' -H &quot;Content-Type: application/json&quot; &lt;http://10.0.30.225/LED&gt;
</code></pre>
<p>will transmit something like the following HTTP request to
<code>urest.http.server.RESTServer</code></p>
<pre><code>PUT /LED HTTP/1.1

Host: 10.0.30.225
User-Agent: curl/7.81.0
Accept: */*
Content-Type: application/json
Content-Length: 11

{&quot;led&quot;:&quot;0&quot;}
</code></pre>
<div class="admonition note">
<p class="admonition-title">Note:&ensp;JSON is Required</p>
<p>The only format accepted by the <code><a title="urest.http.server.RESTServer" href="../http/server.html#urest.http.server.RESTServer">RESTServer</a></code> for the state
of the nouns is <a href="https://www.json.org/json-en.html">JSON</a>. The
<code><a title="urest.http.server.RESTServer" href="../http/server.html#urest.http.server.RESTServer">RESTServer</a></code> will also only accept a sub-set of the JSON
standard: notably assuming a single object, and a collection of key/value pairs.</p>
</div>
<p>The exact interpretation of the JSON is left to the implementation of the noun,
but in most cases the name of the noun is used to set the state value. For
instance in the above example the key <code>led</code> is interpreted as referring to the
noun, and the value <code>0</code> as the state value. In this case setting the GPIO <code>Pin
28&lt;code&gt; to the value &lt;/code&gt;0&lt;code&gt; (or &lt;/code&gt;off</code>). A close correspondence between the name of the
noun as referred to the API, and the name of the noun in the state list is
<strong>strongly</strong> advised: but is not strictly required.</p>
<h2 id="tested-implementations">Tested Implementations</h2>
<p>This version is written for MicroPython 3.4, and has been tested on:</p>
<ul>
<li>Raspberry Pi Pico W</li>
</ul>
<h2 id="licence">Licence</h2>
<p>This module, and all included code, is made available under the terms of the MIT Licence</p>
<blockquote>
<p>Copyright (c) 2022&ndash;2023 David Love</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
</blockquote>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
Abstract base class and helper classes for the server-provided REST API

Overview
--------

During the marshalling of client requests (provided by the
`urest.http.server.RESTServer` class), the path portion of the URI is extracted
from the client. This path is expected to take the form of

&gt; `/&lt; noun &gt;`

with the &#39;verb&#39; denoted by the HTTP methods. Each &#39;noun&#39; is implemented by a
class which inherits from `urest.api.base.APIBase`.

.. Note::

  All nouns are checked by`urest.http.server.RESTServer`, and nouns will not be
  properly routed unless `urest.api.base.APIBase` is an ancestor of the derived
  class.

The &#39;noun&#39; determines the resource of the request, and the &#39;verb&#39; the action to
be taken on that resource. Also important is the intent of the client as
inferred from the underlying HTTP request, e.g. `GET` or `PUT`. Taken together
the URI and the client intent are mapped to methods of `urest.api.base.APIBase`
as follows

| Verb   | HTTP Method | `urest.api.base.APIBase` method      |
|--------|-------------|--------------------------------------------|
| Get    | `GET`       | `urest.api.base.APIBase.get_state`    |
| Set    | `PUT`       | `urest.api.base.APIBase.set_state`    |
| Update | `POST`      | `urest.api.base.APIBase.update_state` |
| Delete | `DELETE`    | `urest.api.base.APIBase.delete_state` |


Example
--------------

### Getting the Noun State

See `urest.example.simpleled.SimpleLED` class a minimal implementation of a noun
controlling on GPIO pin, using the MicroPython `Pin` library. For the
`urest.example.simpleled.SimpleLED` class, the exact pin being controlled is set
during the object instantiation, via the class constructor.

Assuming the `urest.http.server.RESTServer` has been created as

```python app = RESTServer() ```

then a &#39;noun&#39; `led` can be registered via the
`urest.http.server.RESTServer.register_noun` method as

```python app.register_noun(&#39;led&#39;, SimpleLED(28)) ```

This will also bind the controlled GPIO pin to `Pin 28`: documentation for the
micro-controller and platform being used will be need to determine suitable
values.

Once the &#39;noun&#39; has been registered, then the state of GPIO `Pin 28` can be
found by the HTTP request

```
GET /led HTTP 1.1
```

### All Lookup&#39;s Are Case Insensitive

All nouns are registered with `urest.http.server.RESTServer` in **lowercase**.
Likewise all routing of API requests will also assume that the name of the noun
to be used will be in lowercase. Thus, for instance, calling

```python app.register_noun(&#39;leD&#39;, SimpleLED(28)) ```

or

```python app.register_noun(&#39;LED&#39;, SimpleLED(28)) ```

will **all** route to the name noun with the canonical name `led`. Likewise
the request

``` GET /lEd HTTP 1.1 ```

or

``` GET /LED HTTP 1.1 ```

will **also** route to the same noun with the canonical name `led`.

### Setting the Noun State

Setting the state of the noun is a little more involved, as this will require
the desired state of the noun to be sent to the server. A useful tool for
testing purposes is the [curl](https://curl.se) utility; available on most
platforms.

Continuing the minimal example above, the command line

```
curl -X PUT -d &#39;{&#34;led&#34;:&#34;0&#34;}&#39; -H &#34;Content-Type: application/json&#34; http://10.0.30.225/LED
```

will transmit something like the following HTTP request to
`urest.http.server.RESTServer`

```
PUT /LED HTTP/1.1

Host: 10.0.30.225
User-Agent: curl/7.81.0
Accept: */*
Content-Type: application/json
Content-Length: 11

{&#34;led&#34;:&#34;0&#34;}
```

.. NOTE:: JSON is Required

  The only format accepted by the `urest.http.server.RESTServer` for the state
  of the nouns is [JSON](https://www.json.org/json-en.html). The
  `urest.http.server.RESTServer` will also only accept a sub-set of the JSON
  standard: notably assuming a single object, and a collection of key/value pairs.

The exact interpretation of the JSON is left to the implementation of the noun,
but in most cases the name of the noun is used to set the state value. For
instance in the above example the key `led` is interpreted as referring to the
noun, and the value `0` as the state value. In this case setting the GPIO `Pin
28` to the value `0` (or `off`). A close correspondence between the name of the
noun as referred to the API, and the name of the noun in the state list is
**strongly** advised: but is not strictly required.

Tested Implementations
----------------------

This version is written for MicroPython 3.4, and has been tested on:

  * Raspberry Pi Pico W

Licence
-------

This module, and all included code, is made available under the terms of the MIT Licence

&gt; Copyright (c) 2022--2023 David Love

&gt; Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the &#34;Software&#34;), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

&gt; The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

&gt; THE SOFTWARE IS PROVIDED &#34;AS IS&#34;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
&#34;&#34;&#34;

### Expose the `http` module interface
from .base import APIBase</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="urest.api.base" href="base.html">urest.api.base</a></code></dt>
<dd>
<div class="desc"><p>Implements the 'Abstract' Base Class for all the nouns used by the
<code><a title="urest.http.server.RESTServer" href="../http/server.html#urest.http.server.RESTServer">RESTServer</a></code> class in defining resources …</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#example">Example</a><ul>
<li><a href="#getting-the-noun-state">Getting the Noun State</a></li>
<li><a href="#all-lookups-are-case-insensitive">All Lookup's Are Case Insensitive</a></li>
<li><a href="#setting-the-noun-state">Setting the Noun State</a></li>
</ul>
</li>
<li><a href="#tested-implementations">Tested Implementations</a></li>
<li><a href="#licence">Licence</a></li>
</ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="urest" href="../index.html">urest</a></code></li>
</ul>
</li>
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="urest.api.base" href="base.html">urest.api.base</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>